{% extends 'base.html' %} {% block title %}Gerenciar Usuários - LUMOB{% endblock
%} {% block messages %}{% endblock %} {% block content %}
<div class="container mt-4">
  {# Título dentro da faixa preta #}
  <div class="title-band mb-4">
    {# Classe customizada para a faixa #}
    <h1 class="text-white text-center mb-0">Gestão de Usuários</h1>
    {# Título branco e centralizado, sem margem inferior #}
  </div>
  {# Removido:
  <hr class="my-4" />
  separador #} {# Botão para Adicionar Usuário - CORRIGIDO PARA CENTRALIZAR EM
  MOBILE, DIREITA EM DESKTOP #}
  <div class="d-flex justify-content-center justify-content-md-end mb-3">
    {# justify-content-center para mobile (padrão), justify-content-md-end para
    desktop #}
    <a href="{{ url_for('users_bp.add_user') }}" class="btn btn-primary"
      ><i class="fas fa-user-plus me-2"></i> Adicionar Novo Usuário</a
    >
  </div>

  {% if users %}
  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Usuário</th>
          <th scope="col">Email</th>
          <th scope="col">Papel (Role)</th>
          <th scope="col">Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for user_item in users %}
        <tr>
          <td>{{ user_item.id }}</td>
          <td>{{ user_item.username }}</td>
          <td>{{ user_item.email }}</td>
          <td>{{ user_item.role }}</td>
          <td class="text-nowrap">
            <a
              href="{{ url_for('users_bp.edit_user', user_id=user_item.id) }}"
              class="btn btn-sm btn-info me-1"
              data-bs-toggle="tooltip"
              data-bs-placement="top"
              title="Editar"
            >
              <i class="fas fa-edit"></i>
            </a>
            <a
              href="{{ url_for('users_bp.manage_user_permissions', user_id=user_item.id) }}"
              class="btn btn-sm btn-warning me-1"
              data-bs-toggle="tooltip"
              data-bs-placement="top"
              title="Permissões"
            >
              <i class="fas fa-lock"></i>
            </a>
            <form
              action="{{ url_for('users_bp.reset_password', user_id=user_item.id) }}"
              method="POST"
              class="d-inline"
            >
              <button
                type="submit"
                class="btn btn-sm btn-secondary me-1"
                onclick="return confirm('Tem certeza que deseja resetar a senha de {{ user_item.username }} para a padrão?');"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Resetar Senha"
              >
                <i class="fas fa-key"></i>
              </button>
            </form>
            {% if user_item.id != user.id %}
            <form
              action="{{ url_for('users_bp.delete_user', user_id=user_item.id) }}"
              method="POST"
              class="d-inline"
            >
              <button
                type="submit"
                class="btn btn-sm btn-danger"
                onclick="return confirm('Tem certeza que deseja deletar o usuário {{ user_item.username }}? Esta ação é irreversível.');"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Deletar"
              >
                <i class="fas fa-trash-alt"></i>
              </button>
            </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-center">Nenhum usuário encontrado.</p>
  {% endif %}

  <div class="text-center mt-4">
    <a href="{{ url_for('welcome') }}" class="btn btn-secondary"
      >Voltar para a Página Principal</a
    >
  </div>
</div>

<style>
  /* Estilos customizados para o Título como Faixa */
  .title-band {
    background-color: #212529; /* Preto ou cinza escuro */
    padding: 1rem; /* Espaçamento interno */
    border-radius: 0.5rem; /* Cantos levemente arredondados */
    margin-bottom: 1.5rem; /* Margem inferior para separar do conteúdo */
  }
  .title-band h1 {
    color: white; /* Cor do texto do título */
    margin-bottom: 0; /* Remover margem padrão do h1 */
  }
</style>
{% endblock %} {% block scripts %} {{ super() }}
<script>
  var tooltipTriggerList = [].slice.call(
    document.querySelectorAll('[data-bs-toggle="tooltip"]')
  );
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl);
  });
</script>
{% endblock %}
